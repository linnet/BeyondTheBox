<!DOCTYPE html>
<html>
<head>
  <title>dealz</title>
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.1.min.js"></script>
  <script src="http://ajax.aspnetcdn.com/ajax/signalr/jquery.signalr-2.1.0.min.js"></script>
</head>
<body>
  <div>
    <button id="follow">Follow MSFT</button>
    <button id="forget">Forget MSFT</button>
  </div>
  <div>
    <textarea id="jabber_words"></textarea>
    <button id="jabber">Send Message</button>
  </div>
  <script>
    $(function(){
      "use strict";
      
      var FOLLOWMSFT = window.JSON.stringify({ Case: "Follow", Fields: [ "MSFT" ] });
      var FORGETMSFT = window.JSON.stringify({ Case: "Forget", Fields: [ "MSFT" ] });
      
      var c = $.connection('signalr');
      
      c.received(function(msg){ 
        switch(msg.Case){
          case 'Disconnect':
            console.log(msg.Case);
            c.stop(); 
            break
          default:
            if(msg.Fields.length == 0){
              console.log(msg.Case);
            }else{
              console.log(msg.Fields[0]);
            }
            break;
        }
      })
       .start()
       .done(function(){  
          $("#follow").click(function(){ c.send(FOLLOWMSFT); });
          $("#forget").click(function(){ c.send(FORGETMSFT); });
          $("#jabber").click(function(){ 
            var inp = $("#jabber_words");
            var txt = inp.val();
            var msg = { Case : "Jabber", Fields: [ txt ]};
            c.send(window.JSON.stringify(msg));
            inp.val("");
          });
       });
    });
  </script>
</body>
</html>
